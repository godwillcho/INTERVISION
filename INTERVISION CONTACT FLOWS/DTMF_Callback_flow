{"Version":"2019-10-30","StartAction":"Verify if Lambda function was invoked for callback","Metadata":{"entryPointPosition":{"x":-463.2,"y":161.6},"ActionMetadata":{"e0a193cd-da43-4d05-9696-d59fbda66af3":{"position":{"x":1117.6,"y":1160},"dynamicParams":[]},"7c1e8855-f484-4754-a7c0-9dffd7af469e":{"position":{"x":1160,"y":937.6},"dynamicParams":[]},"ERROR PLAY PROMPT":{"position":{"x":1555.2,"y":1079.2},"isFriendlyName":true},"10139196-9e56-4236-9dd3-e9422c86360f":{"position":{"x":1953.6,"y":1120}},"82d66627-e4c6-46ff-8344-6fc8aae9758e":{"position":{"x":332,"y":472.8},"parameters":{"LambdaFunctionARN":{"displayName":"IntervisionCallback_function-2"}},"dynamicMetadata":{"language_control":false}},"23a1e661-70ec-4008-b09b-b7cd228fe1e7":{"position":{"x":1201.6,"y":290.4},"parameters":{"Attributes":{"control1":{"useDynamic":true}}},"dynamicParams":["control1"]},"Gets customer input":{"position":{"x":954.4,"y":140.8},"isFriendlyName":true,"conditionMetadata":[],"countryCodePrefix":"+1"},"fc771f3f-bf87-4f99-b54a-43120fcae3d1":{"position":{"x":326.4,"y":688.8},"parameters":{"LambdaFunctionARN":{"displayName":"IntervisionCallback_function-2"}},"dynamicMetadata":{"language_control":false}},"fdc6bda6-1e52-4928-b69f-278ef1f897d0":{"position":{"x":2132.8,"y":660.8}},"b38666c5-8366-4f25-a8a3-61d304a4db86":{"position":{"x":1773.6,"y":717.6},"parameters":{"QueueId":{"useDynamic":true}},"useDynamic":true},"Confirm Input":{"position":{"x":1455.2,"y":377.6},"isFriendlyName":true,"conditionMetadata":[{"id":"b1e2eb01-00f4-47ce-ace7-15aee66118b8","value":"1"},{"id":"918662b1-858e-4023-8300-9aaf32ac7b1e","value":"2"}]},"a9968e9b-4776-472b-a034-0769c2bff535":{"position":{"x":1732.8,"y":27.2},"parameters":{"QueueId":{"useDynamic":true}},"useDynamic":true},"7e647770-35b4-47b1-884f-cc1e69968a7d":{"position":{"x":2431.2,"y":356}},"f5c1b01f-b33c-446f-8357-fd16602379b2":{"position":{"x":2034.4,"y":336}},"e1c0b367-1a9c-44c4-93f0-5e71027a3c4a":{"position":{"x":2009.6,"y":38.4}},"48a862f9-122b-4447-9610-830a42a54c6a":{"position":{"x":709.6,"y":988.8},"conditions":[],"conditionMetadata":[{"id":"43ca6fdf-7b1e-4124-b934-aef14e187a10","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"},{"id":"f5097589-acf5-425c-8b21-b878a3d99c4d","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"2"}]},"4607f3e8-2191-418b-8c85-ac2f885d5286":{"position":{"x":2444,"y":44.8},"parameters":{"QueueId":{"useDynamic":true}},"useDynamic":true,"queue":"$.Attributes.QUEUE_NUMBER"},"8988b18e-8113-4179-95bc-db3e332f75a6":{"position":{"x":338.4,"y":219.2},"parameters":{"LambdaFunctionARN":{"displayName":"intervision_call_back_function"}},"dynamicMetadata":{"language_control":false}},"cc234b9c-545c-4126-96e0-302f71a41737":{"position":{"x":638.4,"y":177.6},"conditionMetadata":[{"id":"80d98e9b-c253-4140-aa0e-cdfdb1517597","value":"1"},{"id":"c09336d6-2cd9-449a-8be2-e9b7abcaf698","value":"2"}]},"Verify if Lambda function was invoked for callback":{"position":{"x":-105.6,"y":285.6},"isFriendlyName":true,"conditions":[],"conditionMetadata":[{"id":"1d6b46e7-8ffb-4959-ad87-cd0e239b366c","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"0"},{"id":"6fc56697-43b7-4927-8e25-fab2570128b5","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"}]}},"Annotations":[],"name":"DTMF_Callback_flow","description":"","type":"contactFlow","status":"PUBLISHED","hash":{}},"Actions":[{"Parameters":{"Attributes":{"error_val":"$.Attributes.prompt2_fre_error"},"TargetContact":"Current"},"Identifier":"e0a193cd-da43-4d05-9696-d59fbda66af3","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ERROR PLAY PROMPT","Errors":[{"NextAction":"ERROR PLAY PROMPT","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"error_val":"$.Attributes.prompt2_eng_error"},"TargetContact":"Current"},"Identifier":"7c1e8855-f484-4754-a7c0-9dffd7af469e","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ERROR PLAY PROMPT","Errors":[{"NextAction":"ERROR PLAY PROMPT","ErrorType":"NoMatchingError"}]}},{"Parameters":{"SSML":"<speak>\n$.Attributes.error_val\n</speak>"},"Identifier":"ERROR PLAY PROMPT","Type":"MessageParticipant","Transitions":{"NextAction":"10139196-9e56-4236-9dd3-e9422c86360f"}},{"Parameters":{},"Identifier":"10139196-9e56-4236-9dd3-e9422c86360f","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:IntervisionCallback_function-2","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"82d66627-e4c6-46ff-8344-6fc8aae9758e","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"Gets customer input","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"control1":"$.StoredCustomerInput"},"TargetContact":"Current"},"Identifier":"23a1e661-70ec-4008-b09b-b7cd228fe1e7","Type":"UpdateContactAttributes","Transitions":{"NextAction":"Confirm Input","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"True","InputTimeLimitSeconds":"5","SSML":"<speak>\n$.Attributes.selectionn\n</speak>","InputValidation":{"PhoneNumberValidation":{"NumberFormat":"Local","CountryCode":"US"}}},"Identifier":"Gets customer input","Type":"GetParticipantInput","Transitions":{"NextAction":"23a1e661-70ec-4008-b09b-b7cd228fe1e7","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"},{"NextAction":"cc234b9c-545c-4126-96e0-302f71a41737","ErrorType":"InvalidPhoneNumber"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:IntervisionCallback_function-2","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"fc771f3f-bf87-4f99-b54a-43120fcae3d1","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"b38666c5-8366-4f25-a8a3-61d304a4db86","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"CallbackNumber":"$.CustomerEndpoint.Address"},"Identifier":"fdc6bda6-1e52-4928-b69f-278ef1f897d0","Type":"UpdateContactCallbackNumber","Transitions":{"NextAction":"f5c1b01f-b33c-446f-8357-fd16602379b2","Errors":[{"NextAction":"cc234b9c-545c-4126-96e0-302f71a41737","ErrorType":"InvalidCallbackNumber"},{"NextAction":"7e647770-35b4-47b1-884f-cc1e69968a7d","ErrorType":"CallbackNumberNotDialable"}]}},{"Parameters":{"QueueId":"$.Attributes.QUEUE_NUMBER"},"Identifier":"b38666c5-8366-4f25-a8a3-61d304a4db86","Type":"UpdateContactTargetQueue","Transitions":{"NextAction":"fdc6bda6-1e52-4928-b69f-278ef1f897d0","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"5","SSML":"<speak>\n$.Attributes.control1\n$.Attributes.prompt_callback_2\n</speak>"},"Identifier":"Confirm Input","Type":"GetParticipantInput","Transitions":{"NextAction":"a9968e9b-4776-472b-a034-0769c2bff535","Conditions":[{"NextAction":"a9968e9b-4776-472b-a034-0769c2bff535","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"cc234b9c-545c-4126-96e0-302f71a41737","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"a9968e9b-4776-472b-a034-0769c2bff535","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"a9968e9b-4776-472b-a034-0769c2bff535","ErrorType":"NoMatchingCondition"},{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"QueueId":"$.Attributes.QUEUE_NUMBER"},"Identifier":"a9968e9b-4776-472b-a034-0769c2bff535","Type":"UpdateContactTargetQueue","Transitions":{"NextAction":"e1c0b367-1a9c-44c4-93f0-5e71027a3c4a","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{},"Identifier":"7e647770-35b4-47b1-884f-cc1e69968a7d","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{"SSML":"<speak>\n$.Attributes.prompt_confirm\n</speak>"},"Identifier":"f5c1b01f-b33c-446f-8357-fd16602379b2","Type":"MessageParticipant","Transitions":{"NextAction":"4607f3e8-2191-418b-8c85-ac2f885d5286"}},{"Parameters":{"CallbackNumber":"$.StoredCustomerInput"},"Identifier":"e1c0b367-1a9c-44c4-93f0-5e71027a3c4a","Type":"UpdateContactCallbackNumber","Transitions":{"NextAction":"4607f3e8-2191-418b-8c85-ac2f885d5286","Errors":[{"NextAction":"cc234b9c-545c-4126-96e0-302f71a41737","ErrorType":"InvalidCallbackNumber"},{"NextAction":"f5c1b01f-b33c-446f-8357-fd16602379b2","ErrorType":"CallbackNumberNotDialable"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.language_control"},"Identifier":"48a862f9-122b-4447-9610-830a42a54c6a","Type":"Compare","Transitions":{"NextAction":"7e647770-35b4-47b1-884f-cc1e69968a7d","Conditions":[{"NextAction":"7c1e8855-f484-4754-a7c0-9dffd7af469e","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"e0a193cd-da43-4d05-9696-d59fbda66af3","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"7e647770-35b4-47b1-884f-cc1e69968a7d","ErrorType":"NoMatchingCondition"}]}},{"Parameters":{"RetryDelaySeconds":"600","InitialCallDelaySeconds":"99","MaximumConnectionAttempts":"1","QueueId":"$.Attributes.QUEUE_NUMBER"},"Identifier":"4607f3e8-2191-418b-8c85-ac2f885d5286","Type":"CreateCallbackContact","Transitions":{"NextAction":"7e647770-35b4-47b1-884f-cc1e69968a7d","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:intervision_call_back_function","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"8988b18e-8113-4179-95bc-db3e332f75a6","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"cc234b9c-545c-4126-96e0-302f71a41737","Errors":[{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"5","SSML":"<speak> \n$.Attributes.prompt_callback\n</speak>"},"Identifier":"cc234b9c-545c-4126-96e0-302f71a41737","Type":"GetParticipantInput","Transitions":{"NextAction":"b38666c5-8366-4f25-a8a3-61d304a4db86","Conditions":[{"NextAction":"82d66627-e4c6-46ff-8344-6fc8aae9758e","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"fc771f3f-bf87-4f99-b54a-43120fcae3d1","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"10139196-9e56-4236-9dd3-e9422c86360f","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"b38666c5-8366-4f25-a8a3-61d304a4db86","ErrorType":"NoMatchingCondition"},{"NextAction":"48a862f9-122b-4447-9610-830a42a54c6a","ErrorType":"NoMatchingError"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.lambda_invoked"},"Identifier":"Verify if Lambda function was invoked for callback","Type":"Compare","Transitions":{"NextAction":"8988b18e-8113-4179-95bc-db3e332f75a6","Conditions":[{"NextAction":"8988b18e-8113-4179-95bc-db3e332f75a6","Condition":{"Operator":"Equals","Operands":["0"]}},{"NextAction":"cc234b9c-545c-4126-96e0-302f71a41737","Condition":{"Operator":"Equals","Operands":["1"]}}],"Errors":[{"NextAction":"8988b18e-8113-4179-95bc-db3e332f75a6","ErrorType":"NoMatchingCondition"}]}}]}