{"Version":"2019-10-30","StartAction":"05f5203b-a01b-4264-97bd-d26518e8900e","Metadata":{"entryPointPosition":{"x":-2669.6,"y":79.2},"ActionMetadata":{"48e8aa93-820b-490e-aa2f-de53d10aa064":{"position":{"x":-617.6,"y":613.6},"dynamicParams":[]},"51a2c0f9-b8fb-4763-9ecb-0464aea2638a":{"position":{"x":-575.2,"y":391.2},"dynamicParams":[]},"ERROR PLAY PROMPT":{"position":{"x":-180,"y":532.8},"isFriendlyName":true},"d43a9c01-4cc4-4505-8782-7491cc00400d":{"position":{"x":218.4,"y":573.6}},"05f5203b-a01b-4264-97bd-d26518e8900e":{"position":{"x":-2496,"y":335.2},"conditions":[],"conditionMetadata":[{"id":"689c522e-18a0-4dbd-a15b-39beb41bf01d","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"0"},{"id":"fd64b108-bf45-4e86-b737-9c8224d4e558","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"}]},"e0c402fc-be1a-4922-a0ac-8d50ec7e464c":{"position":{"x":-2434.4,"y":6.4},"parameters":{"LambdaFunctionARN":{"displayName":"InterVision_callback_flow_lambda"}},"dynamicMetadata":{"language_control":false}},"ac7d8b0c-02dd-4c79-a447-7155d816c7ec":{"position":{"x":-1973.6,"y":432},"parameters":{"InterruptFrequencySeconds":{"unit":1}},"audio":[],"timeoutUnit":{"value":"sec"}},"5d42e91b-4709-425b-b4e2-ea3e32133a9f":{"position":{"x":-1820.8,"y":182.4},"dynamicParams":[]},"f9c5297c-35ef-4b98-ab6f-8936411bfaaf":{"position":{"x":-533.6,"y":-256},"parameters":{"Attributes":{"control1":{"useDynamic":true}}},"dynamicParams":["control1"]},"da1d4fed-8f03-42f4-9157-24a0671c9f06":{"position":{"x":-1403.2,"y":-73.6},"parameters":{"LambdaFunctionARN":{"displayName":"IntervisionCallback_function-2"}},"dynamicMetadata":{"language_control":false}},"Gets customer input":{"position":{"x":-780.8,"y":-405.6},"isFriendlyName":true,"conditionMetadata":[],"countryCodePrefix":"+1"},"f9c9fee4-9645-466a-8bb7-59076098ad05":{"position":{"x":-1396.8,"y":-327.2},"parameters":{"LambdaFunctionARN":{"displayName":"intervision_call_back_function"}},"dynamicMetadata":{"language_control":false}},"Verify if Lambda function was invoked for callback":{"position":{"x":-1840.8,"y":-260.8},"isFriendlyName":true,"conditions":[],"conditionMetadata":[{"id":"85d1114c-8e75-4788-95d2-a1a48ed79242","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"0"},{"id":"6dd60de8-c280-41a5-bd68-f34a80b51e96","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"}]},"5ad1b987-8fd4-4297-89d2-fb1b28f57d7f":{"position":{"x":-1408.8,"y":142.4},"parameters":{"LambdaFunctionARN":{"displayName":"IntervisionCallback_function-2"}},"dynamicMetadata":{"language_control":false}},"d0c842f2-728e-4974-8fdb-56d6fab67d85":{"position":{"x":397.6,"y":114.4}},"bc84348e-8073-4bde-a0f9-1fefb1685161":{"position":{"x":-842.4,"y":110.4}},"Confirm Input":{"position":{"x":-280,"y":-168.8},"isFriendlyName":true,"conditionMetadata":[{"id":"a6c79087-be33-432a-9c13-a402b1e880dd","value":"1"},{"id":"34cb4269-30fd-4690-9117-55237cfee4c6","value":"2"}]},"6b356419-6c92-455e-8dcc-bbba25875167":{"position":{"x":-1096.8,"y":-368.8},"conditionMetadata":[{"id":"ad19a056-55b9-4913-bead-a1ad274ea01d","value":"1"},{"id":"b807471d-296a-4a6d-a503-a2f6c7c4c130","value":"2"}]},"aa8f0c04-8ed1-47de-808f-10be4f57dc47":{"position":{"x":696,"y":-190.4}},"74ade5e1-c162-4e90-a673-2cacdcea4359":{"position":{"x":299.2,"y":-210.4}},"44d5d84b-c1ec-4009-8c0b-17dc50562dac":{"position":{"x":274.4,"y":-508}},"c920c311-1587-4ed6-a563-31a8b3ac14e2":{"position":{"x":-1025.6,"y":442.4},"conditions":[],"conditionMetadata":[{"id":"b073bca2-6341-4930-bf1e-aae000bdae76","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"},{"id":"753c421d-fecf-4c73-9b9a-057f32806c06","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"2"}]},"79c7e5d3-226f-45f6-a2d0-590f83815f4c":{"position":{"x":708.8,"y":-501.6},"parameters":{"QueueId":{"useDynamic":true}},"useDynamic":true,"queue":"$.Attributes.QUEUE_NUMBER"}},"Annotations":[],"name":"DTMF_customer_queue_flow","description":"","type":"customerQueue","status":"PUBLISHED","hash":{}},"Actions":[{"Parameters":{"Attributes":{"error_val":"$.Attributes.prompt2_fre_error"},"TargetContact":"Current"},"Identifier":"48e8aa93-820b-490e-aa2f-de53d10aa064","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ERROR PLAY PROMPT","Errors":[{"NextAction":"ERROR PLAY PROMPT","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"error_val":"$.Attributes.prompt2_eng_error"},"TargetContact":"Current"},"Identifier":"51a2c0f9-b8fb-4763-9ecb-0464aea2638a","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ERROR PLAY PROMPT","Errors":[{"NextAction":"ERROR PLAY PROMPT","ErrorType":"NoMatchingError"}]}},{"Parameters":{"SSML":"<speak>\n$.Attributes.error_val\n</speak>"},"Identifier":"ERROR PLAY PROMPT","Type":"MessageParticipant","Transitions":{"NextAction":"d43a9c01-4cc4-4505-8782-7491cc00400d"}},{"Parameters":{},"Identifier":"d43a9c01-4cc4-4505-8782-7491cc00400d","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{"ComparisonValue":"$.Attributes.control3"},"Identifier":"05f5203b-a01b-4264-97bd-d26518e8900e","Type":"Compare","Transitions":{"NextAction":"ac7d8b0c-02dd-4c79-a447-7155d816c7ec","Conditions":[{"NextAction":"e0c402fc-be1a-4922-a0ac-8d50ec7e464c","Condition":{"Operator":"Equals","Operands":["0"]}},{"NextAction":"ac7d8b0c-02dd-4c79-a447-7155d816c7ec","Condition":{"Operator":"Equals","Operands":["1"]}}],"Errors":[{"NextAction":"ac7d8b0c-02dd-4c79-a447-7155d816c7ec","ErrorType":"NoMatchingCondition"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:InterVision_callback_flow_lambda","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"e0c402fc-be1a-4922-a0ac-8d50ec7e464c","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"ac7d8b0c-02dd-4c79-a447-7155d816c7ec","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Messages":[{"SSML":"<speak>\n$.Attributes.advert1\n</speak>"},{"SSML":"<speak>\n$.Attributes.advert2\n</speak>"}],"InterruptFrequencySeconds":"10"},"Identifier":"ac7d8b0c-02dd-4c79-a447-7155d816c7ec","Type":"MessageParticipantIteratively","Transitions":{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","Conditions":[{"NextAction":"5d42e91b-4709-425b-b4e2-ea3e32133a9f","Condition":{"Operator":"Equals","Operands":["MessagesInterrupted"]}}],"Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"control3":"1"},"TargetContact":"Current"},"Identifier":"5d42e91b-4709-425b-b4e2-ea3e32133a9f","Type":"UpdateContactAttributes","Transitions":{"NextAction":"Verify if Lambda function was invoked for callback","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"control1":"$.StoredCustomerInput"},"TargetContact":"Current"},"Identifier":"f9c5297c-35ef-4b98-ab6f-8936411bfaaf","Type":"UpdateContactAttributes","Transitions":{"NextAction":"Confirm Input","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:IntervisionCallback_function-2","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"da1d4fed-8f03-42f4-9157-24a0671c9f06","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"Gets customer input","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"True","InputTimeLimitSeconds":"5","SSML":"<speak>\n$.Attributes.selectionn\n</speak>","InputValidation":{"PhoneNumberValidation":{"NumberFormat":"Local","CountryCode":"US"}}},"Identifier":"Gets customer input","Type":"GetParticipantInput","Transitions":{"NextAction":"f9c5297c-35ef-4b98-ab6f-8936411bfaaf","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"},{"NextAction":"6b356419-6c92-455e-8dcc-bbba25875167","ErrorType":"InvalidPhoneNumber"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:intervision_call_back_function","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"f9c9fee4-9645-466a-8bb7-59076098ad05","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"6b356419-6c92-455e-8dcc-bbba25875167","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.lambda_invoked"},"Identifier":"Verify if Lambda function was invoked for callback","Type":"Compare","Transitions":{"NextAction":"f9c9fee4-9645-466a-8bb7-59076098ad05","Conditions":[{"NextAction":"f9c9fee4-9645-466a-8bb7-59076098ad05","Condition":{"Operator":"Equals","Operands":["0"]}},{"NextAction":"6b356419-6c92-455e-8dcc-bbba25875167","Condition":{"Operator":"Equals","Operands":["1"]}}],"Errors":[{"NextAction":"f9c9fee4-9645-466a-8bb7-59076098ad05","ErrorType":"NoMatchingCondition"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:IntervisionCallback_function-2","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"$.Attributes.chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"5ad1b987-8fd4-4297-89d2-fb1b28f57d7f","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"d0c842f2-728e-4974-8fdb-56d6fab67d85","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"CallbackNumber":"$.CustomerEndpoint.Address"},"Identifier":"d0c842f2-728e-4974-8fdb-56d6fab67d85","Type":"UpdateContactCallbackNumber","Transitions":{"NextAction":"74ade5e1-c162-4e90-a673-2cacdcea4359","Errors":[{"NextAction":"6b356419-6c92-455e-8dcc-bbba25875167","ErrorType":"InvalidCallbackNumber"},{"NextAction":"aa8f0c04-8ed1-47de-808f-10be4f57dc47","ErrorType":"CallbackNumberNotDialable"}]}},{"Parameters":{},"Identifier":"bc84348e-8073-4bde-a0f9-1fefb1685161","Type":"EndFlowExecution","Transitions":{}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"5","SSML":"<speak>\n$.Attributes.control1\n$.Attributes.prompt_callback_2\n</speak>"},"Identifier":"Confirm Input","Type":"GetParticipantInput","Transitions":{"NextAction":"bc84348e-8073-4bde-a0f9-1fefb1685161","Conditions":[{"NextAction":"44d5d84b-c1ec-4009-8c0b-17dc50562dac","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"6b356419-6c92-455e-8dcc-bbba25875167","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"bc84348e-8073-4bde-a0f9-1fefb1685161","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"bc84348e-8073-4bde-a0f9-1fefb1685161","ErrorType":"NoMatchingCondition"},{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"5","SSML":"<speak> \n$.Attributes.prompt_callback\n</speak>"},"Identifier":"6b356419-6c92-455e-8dcc-bbba25875167","Type":"GetParticipantInput","Transitions":{"NextAction":"bc84348e-8073-4bde-a0f9-1fefb1685161","Conditions":[{"NextAction":"da1d4fed-8f03-42f4-9157-24a0671c9f06","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"5ad1b987-8fd4-4297-89d2-fb1b28f57d7f","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"bc84348e-8073-4bde-a0f9-1fefb1685161","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"bc84348e-8073-4bde-a0f9-1fefb1685161","ErrorType":"NoMatchingCondition"},{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}},{"Parameters":{},"Identifier":"aa8f0c04-8ed1-47de-808f-10be4f57dc47","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{"SSML":"<speak>\n$.Attributes.prompt_confirm\n</speak>"},"Identifier":"74ade5e1-c162-4e90-a673-2cacdcea4359","Type":"MessageParticipant","Transitions":{"NextAction":"79c7e5d3-226f-45f6-a2d0-590f83815f4c"}},{"Parameters":{"CallbackNumber":"$.StoredCustomerInput"},"Identifier":"44d5d84b-c1ec-4009-8c0b-17dc50562dac","Type":"UpdateContactCallbackNumber","Transitions":{"NextAction":"79c7e5d3-226f-45f6-a2d0-590f83815f4c","Errors":[{"NextAction":"6b356419-6c92-455e-8dcc-bbba25875167","ErrorType":"InvalidCallbackNumber"},{"NextAction":"74ade5e1-c162-4e90-a673-2cacdcea4359","ErrorType":"CallbackNumberNotDialable"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.language_control"},"Identifier":"c920c311-1587-4ed6-a563-31a8b3ac14e2","Type":"Compare","Transitions":{"NextAction":"aa8f0c04-8ed1-47de-808f-10be4f57dc47","Conditions":[{"NextAction":"51a2c0f9-b8fb-4763-9ecb-0464aea2638a","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"48e8aa93-820b-490e-aa2f-de53d10aa064","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"aa8f0c04-8ed1-47de-808f-10be4f57dc47","ErrorType":"NoMatchingCondition"}]}},{"Parameters":{"RetryDelaySeconds":"60","InitialCallDelaySeconds":"2","MaximumConnectionAttempts":"1","QueueId":"$.Attributes.QUEUE_NUMBER"},"Identifier":"79c7e5d3-226f-45f6-a2d0-590f83815f4c","Type":"CreateCallbackContact","Transitions":{"NextAction":"aa8f0c04-8ed1-47de-808f-10be4f57dc47","Errors":[{"NextAction":"c920c311-1587-4ed6-a563-31a8b3ac14e2","ErrorType":"NoMatchingError"}]}}]}