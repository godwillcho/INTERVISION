{"Version":"2019-10-30","StartAction":"Verify if Lambda function was invoked for callback","Metadata":{"entryPointPosition":{"x":-307.2,"y":245.6},"ActionMetadata":{"7f9fb620-b44f-46e0-b628-56dba0377ef6":{"position":{"x":1109.6,"y":1152},"dynamicParams":[]},"ac8932a2-10c5-423d-b592-4f14a4e416c5":{"position":{"x":1152,"y":929.6},"dynamicParams":[]},"ERROR PLAY PROMPT":{"position":{"x":1547.2,"y":1071.2},"isFriendlyName":true},"daa11078-f583-43fc-804c-c881865404d9":{"position":{"x":1945.6,"y":1112}},"a5ffc732-6951-4ac9-ab4b-ada12af105e4":{"position":{"x":330.4,"y":211.2},"parameters":{"LambdaFunctionARN":{"displayName":"intervision_call_back_function"}},"dynamicMetadata":{"language_control":false}},"bf162d3f-b707-4226-be42-6d8665b9c943":{"position":{"x":318.4,"y":680.8},"parameters":{"LambdaFunctionARN":{"displayName":"IntervisionCallback_function-2"}},"dynamicMetadata":{"language_control":false}},"054bf29f-0c95-4b87-8333-56558e2f8608":{"position":{"x":1765.6,"y":709.6},"parameters":{"QueueId":{"displayName":"InterVision_call_back_queue"}},"queue":{"text":"InterVision_call_back_queue"}},"Confirm Input":{"position":{"x":1447.2,"y":369.6},"isFriendlyName":true,"conditionMetadata":[{"id":"f64577a1-1c69-402e-bc35-542337a9d54e","value":"1"},{"id":"248cbf0f-762b-4a59-ac2a-7a7ef9e07760","value":"2"}]},"2e928c6b-2cef-45ea-8f9c-0b85355063eb":{"position":{"x":1724.8,"y":19.2},"parameters":{"QueueId":{"displayName":"InterVision_call_back_queue"}},"queue":{"text":"InterVision_call_back_queue"}},"ad97eeec-8a72-4e8d-9cc5-bc4a66f5b24a":{"position":{"x":2124.8,"y":652.8}},"bf04076e-c798-48f4-9a8f-5816d2ab5101":{"position":{"x":2423.2,"y":348}},"13ccaef1-9c7a-477a-850b-7d23a0990802":{"position":{"x":2001.6,"y":30.4}},"b128f4bf-e85a-434c-a791-0b2eb4222c47":{"position":{"x":2026.4,"y":328}},"b154fac7-e634-4dec-a21e-c36354a95f05":{"position":{"x":2436,"y":36.8},"parameters":{"QueueId":{"displayName":"InterVision_call_back_queue"}},"queue":{"id":"arn:aws:connect:us-west-2:525618997575:instance/1849df04-e6e3-4ee0-ba9a-60f9367efcf6/queue/0c969d4b-f658-4312-9db2-32f5f6ee3a89","text":"InterVision_call_back_queue"}},"1a142cc1-824d-41c7-9dd7-2ef8e5ff8055":{"position":{"x":324,"y":464.8},"parameters":{"LambdaFunctionARN":{"displayName":"IntervisionCallback_function-2"}},"dynamicMetadata":{"language_control":false}},"4419d9cd-97cd-43a5-85c8-0eeecd8063e0":{"position":{"x":1193.6,"y":282.4},"parameters":{"Attributes":{"control1":{"useDynamic":true}}},"dynamicParams":["control1"]},"edab0d3b-e6dd-4e20-9681-6e40af522697":{"position":{"x":630.4,"y":169.6},"conditionMetadata":[{"id":"2aaae9df-0eb0-4307-b489-5020e886f226","value":"1"},{"id":"dcdb15f5-3ae1-4afd-bbaa-7f687a3464e3","value":"2"}]},"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b":{"position":{"x":701.6,"y":980.8},"conditions":[],"conditionMetadata":[{"id":"81fdaafc-a412-4da0-88c8-3a690340921e","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"},{"id":"d426a8ac-f9b8-48cc-83bf-4c65018e2bc8","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"2"}]},"Gets customer input":{"position":{"x":946.4,"y":133.6},"isFriendlyName":true,"conditionMetadata":[],"countryCodePrefix":"+1"},"Verify if Lambda function was invoked for callback":{"position":{"x":15.2,"y":324},"isFriendlyName":true,"conditions":[],"conditionMetadata":[{"id":"c73ee9ec-db08-4e4e-a932-12c27854488e","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"0"},{"id":"920cec83-67e9-48a0-a64d-210535dbb8cd","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"1"}]}},"Annotations":[],"name":"Intervision_Call_Back_flow","description":"","type":"outboundWhisper","status":"SAVED","hash":{}},"Actions":[{"Parameters":{"Attributes":{"error_val":"$.Attributes.prompt2_fre_error"},"TargetContact":"Current"},"Identifier":"7f9fb620-b44f-46e0-b628-56dba0377ef6","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ERROR PLAY PROMPT","Errors":[{"NextAction":"ERROR PLAY PROMPT","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"error_val":"$.Attributes.prompt2_eng_error"},"TargetContact":"Current"},"Identifier":"ac8932a2-10c5-423d-b592-4f14a4e416c5","Type":"UpdateContactAttributes","Transitions":{"NextAction":"ERROR PLAY PROMPT","Errors":[{"NextAction":"ERROR PLAY PROMPT","ErrorType":"NoMatchingError"}]}},{"Parameters":{"SSML":"<speak>\n$.Attributes.error_val\n</speak>"},"Identifier":"ERROR PLAY PROMPT","Type":"MessageParticipant","Transitions":{"NextAction":"daa11078-f583-43fc-804c-c881865404d9"}},{"Parameters":{},"Identifier":"daa11078-f583-43fc-804c-c881865404d9","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:intervision_call_back_function","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"a5ffc732-6951-4ac9-ab4b-ada12af105e4","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"edab0d3b-e6dd-4e20-9681-6e40af522697","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:IntervisionCallback_function-2","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"bf162d3f-b707-4226-be42-6d8665b9c943","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"054bf29f-0c95-4b87-8333-56558e2f8608","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"QueueId":"arn:aws:connect:us-west-2:525618997575:instance/1849df04-e6e3-4ee0-ba9a-60f9367efcf6/queue/0c969d4b-f658-4312-9db2-32f5f6ee3a89"},"Identifier":"054bf29f-0c95-4b87-8333-56558e2f8608","Type":"UpdateContactTargetQueue","Transitions":{"NextAction":"ad97eeec-8a72-4e8d-9cc5-bc4a66f5b24a","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"5","SSML":"<speak>\n$.Attributes.control1\n$.Attributes.prompt_callback_2\n</speak>"},"Identifier":"Confirm Input","Type":"GetParticipantInput","Transitions":{"NextAction":"2e928c6b-2cef-45ea-8f9c-0b85355063eb","Conditions":[{"NextAction":"2e928c6b-2cef-45ea-8f9c-0b85355063eb","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"edab0d3b-e6dd-4e20-9681-6e40af522697","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"2e928c6b-2cef-45ea-8f9c-0b85355063eb","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"2e928c6b-2cef-45ea-8f9c-0b85355063eb","ErrorType":"NoMatchingCondition"},{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"QueueId":"arn:aws:connect:us-west-2:525618997575:instance/1849df04-e6e3-4ee0-ba9a-60f9367efcf6/queue/0c969d4b-f658-4312-9db2-32f5f6ee3a89"},"Identifier":"2e928c6b-2cef-45ea-8f9c-0b85355063eb","Type":"UpdateContactTargetQueue","Transitions":{"NextAction":"13ccaef1-9c7a-477a-850b-7d23a0990802","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"CallbackNumber":"$.CustomerEndpoint.Address"},"Identifier":"ad97eeec-8a72-4e8d-9cc5-bc4a66f5b24a","Type":"UpdateContactCallbackNumber","Transitions":{"NextAction":"b128f4bf-e85a-434c-a791-0b2eb4222c47","Errors":[{"NextAction":"edab0d3b-e6dd-4e20-9681-6e40af522697","ErrorType":"InvalidCallbackNumber"},{"NextAction":"bf04076e-c798-48f4-9a8f-5816d2ab5101","ErrorType":"CallbackNumberNotDialable"}]}},{"Parameters":{},"Identifier":"bf04076e-c798-48f4-9a8f-5816d2ab5101","Type":"DisconnectParticipant","Transitions":{}},{"Parameters":{"CallbackNumber":"$.Attributes.control1"},"Identifier":"13ccaef1-9c7a-477a-850b-7d23a0990802","Type":"UpdateContactCallbackNumber","Transitions":{"NextAction":"b154fac7-e634-4dec-a21e-c36354a95f05","Errors":[{"NextAction":"edab0d3b-e6dd-4e20-9681-6e40af522697","ErrorType":"InvalidCallbackNumber"},{"NextAction":"b128f4bf-e85a-434c-a791-0b2eb4222c47","ErrorType":"CallbackNumberNotDialable"}]}},{"Parameters":{"SSML":"<speak>\n$.Attributes.prompt_confirm\n</speak>"},"Identifier":"b128f4bf-e85a-434c-a791-0b2eb4222c47","Type":"MessageParticipant","Transitions":{"NextAction":"b154fac7-e634-4dec-a21e-c36354a95f05"}},{"Parameters":{"RetryDelaySeconds":"600","InitialCallDelaySeconds":"99","MaximumConnectionAttempts":"1","QueueId":"arn:aws:connect:us-west-2:525618997575:instance/1849df04-e6e3-4ee0-ba9a-60f9367efcf6/queue/0c969d4b-f658-4312-9db2-32f5f6ee3a89"},"Identifier":"b154fac7-e634-4dec-a21e-c36354a95f05","Type":"CreateCallbackContact","Transitions":{"NextAction":"bf04076e-c798-48f4-9a8f-5816d2ab5101","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"LambdaFunctionARN":"arn:aws:lambda:us-west-2:525618997575:function:IntervisionCallback_function-2","InvocationTimeLimitSeconds":"3","LambdaInvocationAttributes":{"language_control":"chosen_lang"},"ResponseValidation":{"ResponseType":"STRING_MAP"}},"Identifier":"1a142cc1-824d-41c7-9dd7-2ef8e5ff8055","Type":"InvokeLambdaFunction","Transitions":{"NextAction":"Gets customer input","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"Attributes":{"control1":"$.StoredCustomerInput"},"TargetContact":"Current"},"Identifier":"4419d9cd-97cd-43a5-85c8-0eeecd8063e0","Type":"UpdateContactAttributes","Transitions":{"NextAction":"Confirm Input","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"StoreInput":"False","InputTimeLimitSeconds":"5","SSML":"<speak> \n$.Attributes.prompt_callback\n</speak>"},"Identifier":"edab0d3b-e6dd-4e20-9681-6e40af522697","Type":"GetParticipantInput","Transitions":{"NextAction":"054bf29f-0c95-4b87-8333-56558e2f8608","Conditions":[{"NextAction":"1a142cc1-824d-41c7-9dd7-2ef8e5ff8055","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"bf162d3f-b707-4226-be42-6d8665b9c943","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"daa11078-f583-43fc-804c-c881865404d9","ErrorType":"InputTimeLimitExceeded"},{"NextAction":"054bf29f-0c95-4b87-8333-56558e2f8608","ErrorType":"NoMatchingCondition"},{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.language_control"},"Identifier":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","Type":"Compare","Transitions":{"NextAction":"bf04076e-c798-48f4-9a8f-5816d2ab5101","Conditions":[{"NextAction":"ac8932a2-10c5-423d-b592-4f14a4e416c5","Condition":{"Operator":"Equals","Operands":["1"]}},{"NextAction":"7f9fb620-b44f-46e0-b628-56dba0377ef6","Condition":{"Operator":"Equals","Operands":["2"]}}],"Errors":[{"NextAction":"bf04076e-c798-48f4-9a8f-5816d2ab5101","ErrorType":"NoMatchingCondition"}]}},{"Parameters":{"StoreInput":"True","InputTimeLimitSeconds":"5","SSML":"<speak>\n$.Attributes.selectionn\n</speak>","InputValidation":{"PhoneNumberValidation":{"NumberFormat":"E164"}}},"Identifier":"Gets customer input","Type":"GetParticipantInput","Transitions":{"NextAction":"4419d9cd-97cd-43a5-85c8-0eeecd8063e0","Errors":[{"NextAction":"0415c94a-4aa1-4efc-b4c0-d619b9e09f1b","ErrorType":"NoMatchingError"},{"NextAction":"edab0d3b-e6dd-4e20-9681-6e40af522697","ErrorType":"InvalidPhoneNumber"}]}},{"Parameters":{"ComparisonValue":"$.Attributes.lambda_invoked"},"Identifier":"Verify if Lambda function was invoked for callback","Type":"Compare","Transitions":{"NextAction":"a5ffc732-6951-4ac9-ab4b-ada12af105e4","Conditions":[{"NextAction":"a5ffc732-6951-4ac9-ab4b-ada12af105e4","Condition":{"Operator":"Equals","Operands":["0"]}},{"NextAction":"edab0d3b-e6dd-4e20-9681-6e40af522697","Condition":{"Operator":"Equals","Operands":["1"]}}],"Errors":[{"NextAction":"a5ffc732-6951-4ac9-ab4b-ada12af105e4","ErrorType":"NoMatchingCondition"}]}}]}